#
# Cookbook Name:: sensu-test
# Recipe:: run_state_helpers
#
# Copyright 2013, Sonian, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# N.B. Defining certificates inline here is for ease-of-testing
# only. Please don't do this in your wrapper cookbook.

static_credentials = {
  "server" => {
    "key" => "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAyBta1eAIDejn91+icHaicmfFt0wiFmtGGZ+gNqvhltoUVKNQ\nMhjc93JssDkasorPTzncGBHTe0zqoIL/PoKly3cV0SWqUm+gbTuepRuh6S5/AWfN\nIC3qcxqOrdZuBUcznX/XZh2LOq3HCVMQfXXljUpysZN8UQqfBE4WZME0eti+C7lB\nldQlzl8HTDMKL1jiCF1EutxoYTr241Ff3n8kvCIyOkvN7s7hIgDj8rQt2CF55dgS\nE3Agbv4N7+MZv1XhTqt/6JY05Q1/8FtGvkF2MXxGcI6y4TEGhhsnr41fbRm1xVqx\n7kCyS4CeoSDxlOQDrx6P466DYThPg5ubVGvRvQIDAQABAoIBAQDByhwR/EBQmDnt\nS2SY3Ys8mFrVxJlOdN0Se5BA4fw6h0AhJ3fGzGVSDjJMB0FfnyZdZ39KoBja1AZ1\nI+fktcmyXcV3Iq7r3sbSgmaFJ1mJ5UmCJvB0NYNTrWh32a361pWZ9fC4J+xqC1ky\nIotZtQ914Z9pcZd3NH4DQUxWjvUv8XcUlf/+DLLjHlOxkpHF2L6W5/OM6HSllSaA\nUkFZ9oPlhIIayJ25Mk1XAb5fut/EHTRzsApWTbvV9OWpfL4pszkXtt2s21DX+wwJ\nAs1ssqXQtPKyXD7wpOIF+K+wghnvqAqMHmVvgT4EK2nnBSQ+qUJ7h/QIXP3xROlv\n8C9xL+SBAoGBAPeTppEb4uneTuC2uNcPREmuQyOdt+CApV51eInsrnlmRPONM4Oh\n3d5FFGYjG9veZgQ5DD8JFA0KxJHAC4zmYokz2gWT3eEGVRyN5s6BODKBmxTbcSB8\nMvjy6+6/ZvLIbRgQfxPH9IzhokwK6YYsFnSwmGWr1kX8FSh55AMoliBZAoGBAM7q\nP/F238HRwiGEqA41crABiBsPYVmg8bRqdK8864JKQx39xUc2LRWbBQafTPGUCPc2\nUkcl8t9onC3Uex6HVq/QaGxLncvYmxrQJ86CceJN2pChn6wPbxPvuARR5kPp5dW5\nNdVedzOz4tDPbpGl5ZPhMtV/IyAFmIBJ1/6FQLAFAoGBAIBlLokq8S9gf3/Cw3Gl\nFUExAtjBvs7LaPfn7C97c7C5/SBiJkkp9SqEoOOnaZdJa5bdDyDR0HhDEVaVRmg4\nQvnszjD+Up+U7Sb14LFQCpkG5iqW88BpKPY65WjYEsfuccV9KKpVlNpLWiQdtKZE\nzxCNVTvFNkbtSPvI2xtYPSNhAoGANs82QPAMNXsqwVYybhEaYCUHuKNKVkObwv6w\nCftJJyokvT0LlOF079QwcKCh8RwVg+aPxOj4fNVpCXrPYjbXb5r1Djq5gdXOwDuD\nT+Cd6iRVURp/AUTVV6KYTAylwjei+goliG+Ng9SSsF1CHLKlLZbpsEQNOd5Blzn4\nTSNfD0ECgYANo15hl6P2xFEXQrWnn3xS9C8gQNhcST/GFtpnZp/dp3IS6TwRkzrC\nXLyAcI+2iiAPGqAcAXRdje99pgxu/zp2brCWksQSUbCmJFvHcX6nL2DmEfJXGpTm\nIZ6sKgjPmXxq1rZyN3TuulANXFS86SVf7ZcJ9KLp3xI7KugiLOppiQ==\n-----END RSA PRIVATE KEY-----\n",
    "cert" => "-----BEGIN CERTIFICATE-----\nMIIC3TCCAcWgAwIBAgIBATANBgkqhkiG9w0BAQUFADASMRAwDgYDVQQDDAdTZW5z\ndUNBMB4XDTE2MDMwMTE2MjkzMFoXDTIxMDIyODE2MjkzMFowITEOMAwGA1UEAxMF\nc2Vuc3UxDzANBgNVBAoTBnNlcnZlcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\nAQoCggEBAMgbWtXgCA3o5/dfonB2onJnxbdMIhZrRhmfoDar4ZbaFFSjUDIY3Pdy\nbLA5GrKKz0853BgR03tM6qCC/z6Cpct3FdElqlJvoG07nqUboekufwFnzSAt6nMa\njq3WbgVHM51/12YdizqtxwlTEH115Y1KcrGTfFEKnwROFmTBNHrYvgu5QZXUJc5f\nB0wzCi9Y4ghdRLrcaGE69uNRX95/JLwiMjpLze7O4SIA4/K0LdgheeXYEhNwIG7+\nDe/jGb9V4U6rf+iWNOUNf/BbRr5BdjF8RnCOsuExBoYbJ6+NX20ZtcVase5AskuA\nnqEg8ZTkA68ej+Oug2E4T4Obm1Rr0b0CAwEAAaMvMC0wCQYDVR0TBAIwADALBgNV\nHQ8EBAMCBSAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDQYJKoZIhvcNAQEFBQADggEB\nAJoBRdIDCnnqG8HTI+Da3OlvCSvAHCvv3q7rKBDrDTini3cg7zYZOHkEWc2pInwu\nkt/ijwrAekm0LjHWluG3YkpmY7O+mZu6q8kxyqBDXQB5NcOaNKooYKMRMGh8XFjb\nyBBPsippX7bKewgPnBZABLa9anjFc4SY4XFriGOdUTWT/YoVgalFyZdAnCzxUnnd\n+BrAVDKHcwZX2zk+H+gEc1AgaPkkmdJvWo0kX3dFttlWnv7ckgrCIQWsF0z22BUA\nRW6kcsm1vBL2OkxmAEoac3H9yLZa8JtqWBxEVgw4Lx7WatBju0VURXfLTS+em/mx\ncE60cNHwiq7iJrjpMGKqJDw=\n-----END CERTIFICATE-----\n",
    "cacert" => "-----BEGIN CERTIFICATE-----\nMIICxDCCAaygAwIBAgIJAM081VFFJwPFMA0GCSqGSIb3DQEBBQUAMBIxEDAOBgNV\nBAMMB1NlbnN1Q0EwHhcNMTYwMzAxMTYyOTI5WhcNMjEwMjI4MTYyOTI5WjASMRAw\nDgYDVQQDDAdTZW5zdUNBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA\nxASZYj/2F7M2PsyqoWR+M6+02CvCYSPasz2r+VTKtP17V6i2UPsjC1HpD3Tk8WTO\nUk69p7isayBHUMvQPSBSKo3ClZEJJdCt9zkft92vus84ad97fV7aPhPK9euDOfCz\nopQx9NolR2tKCZ4xYkF+ag2adGBOUFoWikHRlobpn/XQOQgQaaxbpPLTnjnwFi00\nED9nJGRy2nsVm+lkx/RqZdBGC/tD21ZDz4VDQCspceXtiE/0pL4XzIqoLQ8Y7A4c\nU5H7PhLHLk79xjYrCZGQuwnGx1pD/KcXEK+4Uaf47qXa/D/1CU1P3AoKHSZZADrm\nwD2jfilcwETK3OiJUJwi6wIDAQABox0wGzAMBgNVHRMEBTADAQH/MAsGA1UdDwQE\nAwIBBjANBgkqhkiG9w0BAQUFAAOCAQEAjZud/KhUBZu9DFwdkq6Rku859QENtZaj\n7Wjhycq6RnW+PjvNdaiRz+eHyCaLS6d1yoX/pJCg+9zX0BuBIAdftJqO8aDXe8uA\nvCs4Rp2q50kvErHBUo5KsqBYmkHJAswTR/p2j9VNy2dS9CqAeapomLFME9yPWqBL\nSWrnlJ2NY29KCLEc529DOd7spOIrFyXctUPGCoGts0SeCxFDnEod32KiRg5X6H6V\nr69j6Tgf7m2DnIXQGdpSnGLicAoACFIRR10LqqRaZ6WZXgNxoHiZZcGnvqIDRhxR\nKxNs+fSjVXUTfD106EX0O8z/OE2vxkwPe19nNPaw52Mm3MfQB3W1bw==\n-----END CERTIFICATE-----\n"
  },
  "client" => {
    "key" => "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAvFhUiIQsU0YpNmmIOXsRZ8liDINKqbS7XvmgcVov48Lj0o9r\nRv7IM42g0TgmTK/DswI6RJraP5FC94t+NvbM+ZY31XwxEt7odskxkwP9Ow1qN4Nx\nQ3oiJyvDEwAQSdWLu4UMzKf8IPGix0uEgPe6c48xinB7PGAiZgj36Uzco0xxI7Yv\nHqdWycChNvprjAxnNlmBs8O6WLhL2hkHMpUm1FoaFePG3ReUo6JIW1KVXiUcb3IV\n2Sfuk1gGlXnVFqq6KwL7wYkTQuYsmnmNasRprVw+Jmjux0g9lznl/Nj9S1ji9DNU\n78g0+UwkHww6FOx/eftrfD6ev4hGJLXeYSrAVQIDAQABAoIBAC+j5BX34MJbj9cc\nkIGBmKB49t0VZJBSj8ZxO90QI+bnh/rdnhQCJB+uJkxleIKTPtwLpzNtO+EyXA8D\ncLR0btp+3baZSExup7xMHccDDk2ekgxiqgaYYQUpc5ldvcD/S+3ttJQbtZGbrUHd\n3zFD+Bx8ztomo3VdF7ZZdGPFtlVzdFJ4n91/Q6KsAnWgqLMZSRkz6/nXX4O6vUD8\nq3OwNb1u25Tt/12OD49n6SRqUS9NGpVwFo/6KQpOEyuh93ysnWtpfaXUd1fx3tbK\nF5/2svXQdR+bq8grP6taesN9J4R0HQtSA8xIO9sARMJzfTPDTasaY7WodDhQxayx\nizKliM0CgYEA4sFFg6C45N6gEHFusnP1tiAsAV4dF4hUlbnbkanTbVZ+4iLhFLc+\naWWURuJBhxajRPf1lImsKpHGxxChu88Ms5cZ+EiGit19CbwRgdaMLcX5M7gdma/g\nXDzPJquA0WzP7ylmpySrNBDYduE+1vqNRoO8ox8AcAuElCsKcobMNfMCgYEA1KLi\nisAuJUp2fSI3yOlbrEa7AObjQpI2M29y5p5OGHjb5dd3cOhg1apB0wPcqd/RYBVV\nzgPoxzIWd+AQdtL1aqn60YpN7FpVrmb8cmXuhnxr79ouzZC92rv3+PefEgn/XLij\nNl4RtmguAFBoSV72W3iNl3SLQsB6JNF7vBei2pcCgYEAz3yKXydyB/qt/F3PLPtu\nmnhVy+qSNDZLL7Yhc+gxzpqW/9Vqn8oNEeQhCbt+ul28iB9cV86h+1Ho0b4mP/P1\na1+YI9g5RFfnUkEExAnNuxSsMucGLtsAMWZzJq9H8Fng6ra3d7nV7o57hEwXdB9P\npnZk5d44SE5BwlKf/KvbsIECgYEAt9GEBCy097nSisSc8wuBG4IdwV7YEcGyJ27u\nJp2tp4w7lQtajvnkVHGV6+SHyzbYmrZ28d0BS8pqEAFcWkxuqmH9mU11paBGN7mB\n/SdPN2WyLawxD7ZT2hbq/IicNAz+e9qGBcb2iviu48ifDuaQFG04AjlW9kLMlK2f\nyO+p8ksCgYBi2Oac89YQyCtL6BLGvtpOGj/VxWE9P6c87QC9zrAMgep+rYW4GLT/\n6ard/YUO4UXnPonFXPYtfaaPuMwJYXGs4GWZw/bwWDxZwMi/nofHkIUIiOG83Wpv\npVpavrBjDosDhAqzHMbhdbr91CBCea8FZ00zThkXzTe/q/3cyohiyw==\n-----END RSA PRIVATE KEY-----\n",
    "cert" => "-----BEGIN CERTIFICATE-----\nMIIC3TCCAcWgAwIBAgIBAjANBgkqhkiG9w0BAQUFADASMRAwDgYDVQQDDAdTZW5z\ndUNBMB4XDTE2MDMwMTE2MjkzMFoXDTIxMDIyODE2MjkzMFowITEOMAwGA1UEAxMF\nc2Vuc3UxDzANBgNVBAoTBmNsaWVudDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\nAQoCggEBALxYVIiELFNGKTZpiDl7EWfJYgyDSqm0u175oHFaL+PC49KPa0b+yDON\noNE4Jkyvw7MCOkSa2j+RQveLfjb2zPmWN9V8MRLe6HbJMZMD/TsNajeDcUN6Iicr\nwxMAEEnVi7uFDMyn/CDxosdLhID3unOPMYpwezxgImYI9+lM3KNMcSO2Lx6nVsnA\noTb6a4wMZzZZgbPDuli4S9oZBzKVJtRaGhXjxt0XlKOiSFtSlV4lHG9yFdkn7pNY\nBpV51RaquisC+8GJE0LmLJp5jWrEaa1cPiZo7sdIPZc55fzY/UtY4vQzVO/INPlM\nJB8MOhTsf3n7a3w+nr+IRiS13mEqwFUCAwEAAaMvMC0wCQYDVR0TBAIwADALBgNV\nHQ8EBAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQEFBQADggEB\nACZPJJA37VjPBko7eiX9rruVrtXYxzyQOyV8DfbCj9KQUld2F31AG0WXMjZNw2n+\nkUMFaCMMew2vz9Fe1wg+nUrPGQbeac2XZkSGgwsnMYwPmCr8TDC2QvkeJ/xgxqZE\nmp4C6qXry3yv5JcbbS0a2cdgrqDD0PXgsLQswwW5nWFiBWkEfxMzpPFiqEQ/T2bN\nB/cKDxZEPrL/DovJ+aYVA76ZJ3hG5xoKVxf6+qAH/+TjEtnrUZ2krRNVl+QvX+lG\nXjEgKF7AEM8DGBqV0G2ZD/ZL19DZWq9VnVRAzftwrnNqNkIHgsqj//i5hWlryV9/\nsYRwEnDUiLLs6mpHlLwvmZI=\n-----END CERTIFICATE-----\n"
  }
}

# Use helper to store the static_credentials hash under `node.run_state['sensu']['ssl]`
# for the duration of this Chef run, then include sensu-test::default
set_sensu_state(node, "ssl", static_credentials)
include_recipe "sensu-test::default"
