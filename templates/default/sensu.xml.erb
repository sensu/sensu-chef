<!--
  Windows service definition for Sensu
  MANAGED BY CHEF
-->
<service>
  <id><%= @service %></id>
  <name><%= @name %></name>
  <description>This service runs a <%= @name %></description>
  <executable>C:\opt\sensu\embedded\bin\ruby</executable>
  <argument>C:\opt\sensu\embedded\bin\<%= @service %></argument>
  <argument>-c</argument>
  <argument><%= node["sensu"]["directory"] %>\config.json</argument>
  <argument>-d</argument>
  <argument><%= node["sensu"]["directory"] %>\conf.d</argument>
  <argument>-e</argument>
  <argument><%= node["sensu"]["directory"] %>\extensions</argument>
  <argument>-L</argument>
  <argument><%= node["sensu"]["log_level"] %></argument>
  <logpath><%= node["sensu"]["log_directory"] %>\</logpath>
  <log mode="roll-by-size">
        <sizeThreshold><%= node["sensu"]["log_rotate_file_size"] %></sizeThreshold>
        <keepFiles><%= node["sensu"]["log_rotate_file_keep"] %></keepFiles>
  </log>   
</service>
